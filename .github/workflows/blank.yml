name: Wechat steps update

on:
  schedule:
    - cron: '0 13 * * *'  # ÊØèÂ§© UTC 13 ÁÇπÔºåÂç≥Âåó‰∫¨Êó∂Èó¥ 21 ÁÇπÔºàÊôö‰∏ä9ÁÇπÔºâ
  workflow_dispatch:

jobs:
  update-steps:
    runs-on: ubuntu-latest

    steps:
      - name: Submit steps
        env:
          EMAIL: ${{ secrets.STEP_EMAIL }}
          PASSWORD: ${{ secrets.STEP_PASSWORD }}
          API_URL: ${{ vars.STEP_API_URL }}
          STEP_MIN: ${{ vars.STEP_MIN }}
          STEP_MAX: ${{ vars.STEP_MAX }}
        run: |
          RANGE=$((STEP_MAX - STEP_MIN + 1))
          RANDOM_STEP=$((RANDOM % RANGE + STEP_MIN))
          echo "üí° Êèê‰∫§Ê≠•Êï∞: $RANDOM_STEP"

          curl -s -X POST "$API_URL" \
            -H "accept: */*" \
            -H "user-agent: Mozilla/5.0" \
            --form "account=$EMAIL" \
            --form "password=$PASSWORD" \
            --form "steps=$RANDOM_STEP"
